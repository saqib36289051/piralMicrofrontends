var piralDashboard=(()=>{var N=Object.create;var b=Object.defineProperty;var j=Object.getOwnPropertyDescriptor;var O=Object.getOwnPropertyNames;var _=Object.getPrototypeOf,$=Object.prototype.hasOwnProperty;var w=e=>b(e,"__esModule",{value:!0});var n=(e=>typeof require!="undefined"?require:typeof Proxy!="undefined"?new Proxy(e,{get:(r,t)=>(typeof require!="undefined"?require:r)[t]}):e)(function(e){if(typeof require!="undefined")return require.apply(this,arguments);throw new Error('Dynamic require of "'+e+'" is not supported')});var A=(e,r)=>{w(e);for(var t in r)b(e,t,{get:r[t],enumerable:!0})},q=(e,r,t)=>{if(r&&typeof r=="object"||typeof r=="function")for(let o of O(r))!$.call(e,o)&&o!=="default"&&b(e,o,{get:()=>r[o],enumerable:!(t=j(r,o))||t.enumerable});return e},l=e=>q(w(b(e!=null?N(_(e)):{},"default",e&&e.__esModule&&"default"in e?{get:()=>e.default,enumerable:!0}:{value:e,enumerable:!0})),e);var J={};A(J,{Dashboard:()=>f,PiralDashboardContainer:()=>y,PiralDashboardTile:()=>x,createDashboardApi:()=>H});var D={};A(D,{registerTile:()=>v,unregisterTile:()=>B});var T=l(n("piral-core"));function v(e,r,t){e.dispatch(o=>({...o,registry:{...o.registry,tiles:(0,T.withKey)(o.registry.tiles,r,t)}}))}function B(e,r){e.dispatch(t=>({...t,registry:{...t.registry,tiles:(0,T.withoutKey)(t.registry.tiles,r)}}))}var s=l(n("piral-core"));var g=l(n("react")),S=l(n("piral-core"));var P=l(n("piral-core")),y=(0,P.getPiralComponent)("DashboardContainer"),x=(0,P.getPiralComponent)("DashboardTile");var f=e=>{let r=(0,S.useGlobalState)(i=>i.registry.tiles),{filter:t=()=>!0}=e,o=Object.keys(r).filter(i=>t(r[i])).map(i=>{let{component:p,preferences:u}=r[i],{initialColumns:c=1,initialRows:h=1,resizable:a=!1}=u;return g.createElement(x,{key:i,columns:c,rows:h,resizable:a,meta:u},g.createElement(p,{columns:c,rows:h}))});return g.createElement(y,{...e,children:o})};f.displayName="Dashboard";var G=l(n("react")),d=l(n("piral-core")),I=e=>G.createElement(d.ExtensionSlot,{name:"dashboard",params:e,empty:()=>(0,d.defaultRender)(e.children,"default_dashboard")}),F=e=>(0,d.defaultRender)(e.children);function C(e,r={}){return{...e,...r}}function k(e,r){let t={},o=0;for(let{component:i,preferences:p}of e)t[`global-${o++}`]={pilet:void 0,component:i,preferences:C(r,p)};return t}function z(e){return r=>({...r,components:{DashboardTile:F,DashboardContainer:I,...r.components},registry:{...r.registry,tiles:e}})}function E(e){return r=>({...r,routes:{...r.routes,...e.reduce((t,o)=>(t[o]=f,t),{})}})}function H(e={}){let{tiles:r=[],defaultPreferences:t={},routes:o=["/"]}=e;return i=>(i.defineActions(D),i.dispatch((0,s.withAll)(z(k(r,t)),(0,s.withRootExtension)("piral-dashboard",f),E(o))),(p,u)=>{let c=u.name,h=0;return{registerTile(a,m,R){typeof a!="string"&&(R=m,m=a,a=h++);let K=(0,s.buildName)(c,a);return i.registerTile(K,{pilet:c,component:(0,s.withApi)(i,m,p,"tile"),preferences:C(t,R)}),()=>p.unregisterTile(a)},unregisterTile(a){let m=(0,s.buildName)(c,a);i.unregisterTile(m)}}})}return J;})();
