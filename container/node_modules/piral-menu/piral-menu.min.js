var piralMenu=(()=>{var k=Object.create;var M=Object.defineProperty;var E=Object.getOwnPropertyDescriptor;var K=Object.getOwnPropertyNames;var N=Object.getPrototypeOf,T=Object.prototype.hasOwnProperty;var x=e=>M(e,"__esModule",{value:!0});var u=(e=>typeof require!="undefined"?require:typeof Proxy!="undefined"?new Proxy(e,{get:(t,n)=>(typeof require!="undefined"?require:t)[n]}):e)(function(e){if(typeof require!="undefined")return require.apply(this,arguments);throw new Error('Dynamic require of "'+e+'" is not supported')});var h=(e,t)=>{x(e);for(var n in t)M(e,n,{get:t[n],enumerable:!0})},_=(e,t,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let r of K(t))!T.call(e,r)&&r!=="default"&&M(e,r,{get:()=>t[r],enumerable:!(n=E(t,r))||n.enumerable});return e},s=e=>_(x(M(e!=null?k(N(e)):{},"default",e&&e.__esModule&&"default"in e?{get:()=>e.default,enumerable:!0}:{value:e,enumerable:!0})),e);var z={};h(z,{Menu:()=>I,PiralMenuContainer:()=>C,PiralMenuItem:()=>P,createMenuApi:()=>v});var y={};h(y,{registerMenuItem:()=>$,unregisterMenuItem:()=>j});var g=s(u("piral-core"));function $(e,t,n){e.dispatch(r=>({...r,registry:{...r.registry,menuItems:(0,g.withKey)(r.registry.menuItems,t,n)}}))}function j(e,t){e.dispatch(n=>({...n,registry:{...n.registry,menuItems:(0,g.withoutKey)(n.registry.menuItems,t)}}))}var o=s(u("piral-core"));var R=s(u("react")),c=s(u("piral-core")),b=e=>R.createElement(c.ExtensionSlot,{name:`menu_${e.type}`,params:e,empty:()=>(0,c.defaultRender)(e.children,"default_menu")}),A=e=>(0,c.defaultRender)(e.children);var f=s(u("react")),D=s(u("piral-core"));var d=s(u("piral-core")),C=(0,d.getPiralComponent)("MenuContainer"),P=(0,d.getPiralComponent)("MenuItem");var I=({type:e="general"})=>{let t=(0,D.useGlobalState)(i=>i.registry.menuItems),r=Object.keys(t).filter(i=>t[i].settings.type===e).map(i=>({name:i,Component:t[i].component,meta:t[i].settings})).map(({name:i,Component:a,meta:p})=>f.createElement(P,{key:i,type:e,meta:p},f.createElement(a,null)));return f.createElement(C,{type:e},r)};I.displayName="Menu";function G(e,t={}){return{type:"general",...e,...t}}function O(e,t){let n={},r=0;for(let{component:i,settings:a}of e)n[`global-${r++}`]={pilet:void 0,component:i,settings:G(t,a)};return n}function q(e){return t=>({...t,components:{MenuContainer:b,MenuItem:A,...t.components},registry:{...t.registry,menuItems:e}})}function v(e={}){let{items:t=[],defaultSettings:n={}}=e;return r=>(r.defineActions(y),r.dispatch((0,o.withAll)(q(O(t,n)),(0,o.withRootExtension)("piral-menu",I))),(i,a)=>{let p=a.name,w=0;return{registerMenu(m,l,S){typeof m!="string"&&(S=l,l=m,m=w++);let F=(0,o.buildName)(p,m);return r.registerMenuItem(F,{pilet:p,component:(0,o.withApi)(r,l,i,"menu"),settings:G(n,S)}),()=>i.unregisterMenu(m)},unregisterMenu(m){let l=(0,o.buildName)(p,m);r.unregisterMenuItem(l)}}})}return z;})();
